{"id":"mpVp","dependencies":[{"name":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\package.json","includedInParent":true,"mtime":1720181853972},{"name":"textalive-app-api","loc":{"line":1,"column":23,"index":23},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\textalive-app-api\\dist\\index.es.js"},{"name":"three","loc":{"line":2,"column":23,"index":68},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\build\\three.module.js"},{"name":"three/examples/jsm/loaders/FontLoader.js","loc":{"line":3,"column":27,"index":105},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\loaders\\FontLoader.js"},{"name":"three/examples/jsm/geometries/TextGeometry.js","loc":{"line":4,"column":29,"index":179},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\geometries\\TextGeometry.js"},{"name":"three/examples/jsm/controls/OrbitControls.js","loc":{"line":5,"column":30,"index":259},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\controls\\OrbitControls.js"}],"generated":{"js":"\"use strict\";var e,t,n,o,r,a=require(\"textalive-app-api\"),i=c(require(\"three\")),d=require(\"three/examples/jsm/loaders/FontLoader.js\"),s=require(\"three/examples/jsm/geometries/TextGeometry.js\"),u=require(\"three/examples/jsm/controls/OrbitControls.js\");function l(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var o={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(\"default\"!==a&&{}.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(o,a,i):o[a]=e[a]}return o.default=e,n&&n.set(e,o),o}var m,p=\"\",f=[],h=[],y=0,g={},v=[],w=null,E=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),b=new a.Player({app:{token:\"GfeiLX99kNC1YEyp\",valenceArousalEnabled:!0,vocalAmplitudeEnabled:!0},mediaElement:document.createElement(\"audio\")});function M(){(new d.FontLoader).load(\"Zen Old Mincho Black_Regular.json\",function(e){w=e})}function B(){var e,t=document.getElementById(\"playBtn\"),n=document.getElementById(\"pauseBtn\"),o=document.getElementById(\"explodeBtn\"),r=document.getElementById(\"volumeSlider\"),a=document.getElementById(\"hamburger-menu\"),i=document.getElementById(\"controls\"),d=document.getElementById(\"seekbar\");t.addEventListener(\"click\",P),n.addEventListener(\"click\",I),r.addEventListener(\"input\",j),r.addEventListener(\"change\",j),a.addEventListener(\"click\",function(){i.classList.toggle(\"hidden\")}),d.addEventListener(\"input\",x),o.addEventListener(\"touchstart\",function(){e=Date.now()}),o.addEventListener(\"touchend\",function(){Date.now()-e<300&&L()}),o.addEventListener(\"click\",L)}function P(){b.requestPlay()}function I(){b.requestPause()}function x(){var e=document.getElementById(\"seekbar\");b.requestMediaSeek(e.value)}function L(){f.forEach(function(e){var t=new i.Vector3(.5*(Math.random()-.5),.5*(Math.random()-.5),.5*(Math.random()-.5));e.position.add(t)}),A()}function A(){for(var e=E?50:100,n=new i.BufferGeometry,o=new Float32Array(3*e),r=new Float32Array(3*e),a=new Float32Array(3*e),d=new Float32Array(3*e),s=new i.Color,u=0;u<e;u++){var l=10*(Math.random()-.5),c=10*(Math.random()-.5),p=10*(Math.random()-.5);o[3*u]=l,o[3*u+1]=c,o[3*u+2]=p,a[3*u]=.1*(Math.random()-.5),a[3*u+1]=-.1*Math.random()-.05,a[3*u+2]=.1*(Math.random()-.5),d[3*u]=Math.random()*Math.PI*2,d[3*u+1]=Math.random()*Math.PI*2,d[3*u+2]=Math.random()*Math.PI*2,s.setHSL(Math.random(),1,.5),r[3*u]=s.r,r[3*u+1]=s.g,r[3*u+2]=s.b}n.setAttribute(\"position\",new i.BufferAttribute(o,3)),n.setAttribute(\"color\",new i.BufferAttribute(r,3));var f=new i.PointsMaterial({size:.1,vertexColors:!0});(m=new i.Points(n,f)).userData.velocities=a,m.userData.rotations=d,t.add(m),setTimeout(function(){t.remove(m),m.geometry.dispose(),m.material.dispose(),m=null},3e3)}function k(){if(m){for(var e=m.geometry.attributes.position.array,t=m.userData.velocities,n=m.userData.rotations,o=0;o<e.length;o+=3){e[o]+=t[o],e[o+1]+=t[o+1],e[o+2]+=t[o+2],t[o+1]-=.0098,n[o]+=.01,n[o+1]+=.01,n[o+2]+=.01;var r=.3*Math.sin(n[o])+.7;m.geometry.attributes.position.array[o]*=r,m.geometry.attributes.position.array[o+1]*=r}m.geometry.attributes.position.needsUpdate=!0}}function j(){var e=document.getElementById(\"volumeSlider\").value/100;b.volume=100*e,console.log(b.volume)}function S(){var a;t=new i.Scene,n=new i.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),o=new i.WebGLRenderer({antialias:!1,powerPreference:\"low-power\"}),E?o.setPixelRatio(1):o.setPixelRatio(Math.min(window.devicePixelRatio,2)),o.setSize(window.innerWidth,window.innerHeight),document.getElementById(\"container\").appendChild(o.domElement),(new i.TextureLoader).load(\"starry_sky.jpg\",function(e){e.minFilter=i.LinearFilter,t.background=e}),n.position.z=5,(r=new u.OrbitControls(n,o.domElement)).enableDamping=!0,r.dampingFactor=.25,r.screenSpacePanning=!1,r.minDistance=1,r.maxDistance=100,e=new i.Group,t.add(e),z(),window.addEventListener(\"resize\",function(){clearTimeout(a),a=setTimeout(C,100)})}function O(){if(p&&w){var t=E?3:5;p.split(/\\s+/).slice(0,t).forEach(function(t,n){g[t]||(g[t]=new s.TextGeometry(t,{font:w,size:.4,height:.1}),g[t].center());var o=D(t,new i.MeshBasicMaterial({color:16777215}));o.position.set(5*(Math.random()-.5),10+2*n,5*(Math.random()-.5)),f.push(o),h.push({mesh:o,speed:.05+.05*Math.random(),rotationSpeed:{x:.02*(Math.random()-.5),y:.02*(Math.random()-.5),z:.02*(Math.random()-.5)}}),e.add(o)})}}function D(e,t){if(v.length>0){var n=v.pop();return n.geometry=g[e],n.material=t,n}return new i.Mesh(g[e],t)}function F(e){v.length<50?v.push(e):W(e)}function T(){var e=b.getValenceArousal(b.timer.position),t=b.getValenceArousal(b.timer.position),n=new i.Color;n.setHSL((e+1)/2,1,(t+1)/2),f.forEach(function(e){e.material.color.set(n)})}function q(){for(var t=h.length-1;t>=0;t--){var n=h[t];n.mesh.position.y-=n.speed,n.mesh.rotation.x+=n.rotationSpeed.x,n.mesh.rotation.y+=n.rotationSpeed.y,n.mesh.rotation.z+=n.rotationSpeed.z,n.mesh.position.y<-5&&(e.remove(n.mesh),h.splice(t,1),F(n.mesh))}}function z(e){requestAnimationFrame(z),e-y>1e3/(E?20:30)&&(y=e,q(),k(),r.update(),o&&n&&o.render(t,n))}function C(){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function W(e){e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(function(e){return e.dispose()}):e.material.dispose())}function _(){f.forEach(function(e){W(e)}),f=[],h=[],m&&(t.remove(m),m.geometry.dispose(),m.material.dispose(),m=null),Object.values(g).forEach(function(e){return e.dispose()}),g={},v.forEach(function(e){return W(e)}),v=[]}function R(e,t){var n;return function(){for(var o=this,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];clearTimeout(n),n=setTimeout(function(){return e.apply(o,a)},t)}}b.addListener({onAppReady:function(e){e.managed||b.createFromSongUrl(\"https://piapro.jp/t/YW_d/20210206123357\"),B()},onVideoReady:function(e){document.getElementById(\"playBtn\").disabled=!1,document.getElementById(\"pauseBtn\").disabled=!1,document.getElementById(\"explodeBtn\").disabled=!1,document.getElementById(\"seekbar\").max=b.video.duration},onTimerReady:function(){S()},onTimeUpdate:function(e){if(b.video){var t=b.timer.position,n=b.video.findChar(t);n&&n.text!==p&&(p=n.text,G()),T(),document.getElementById(\"seekbar\").value=t}},onPlay:function(){document.getElementById(\"playBtn\").disabled=!0,document.getElementById(\"pauseBtn\").disabled=!1},onPause:function(){document.getElementById(\"playBtn\").disabled=!1,document.getElementById(\"pauseBtn\").disabled=!0}}),M(),window.addEventListener(\"beforeunload\",_);var G=R(O,300);"},"sourceMaps":null,"error":null,"hash":"929d291e9f84e2a3c18b0e11ffbfb7d5","cacheData":{"env":{}}}