{"id":"mpVp","dependencies":[{"name":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\package.json","includedInParent":true,"mtime":1720181853972},{"name":"textalive-app-api","loc":{"line":1,"column":23,"index":23},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\textalive-app-api\\dist\\index.es.js"},{"name":"three","loc":{"line":2,"column":23,"index":68},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\build\\three.module.js"},{"name":"three/examples/jsm/loaders/FontLoader.js","loc":{"line":3,"column":27,"index":105},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\loaders\\FontLoader.js"},{"name":"three/examples/jsm/geometries/TextGeometry.js","loc":{"line":4,"column":29,"index":179},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\geometries\\TextGeometry.js"},{"name":"three/examples/jsm/controls/OrbitControls.js","loc":{"line":5,"column":30,"index":259},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\controls\\OrbitControls.js"}],"generated":{"js":"\"use strict\";var e,t,n,o,r,a=require(\"textalive-app-api\"),i=m(require(\"three\")),d=require(\"three/examples/jsm/loaders/FontLoader.js\"),s=require(\"three/examples/jsm/geometries/TextGeometry.js\"),u=require(\"three/examples/jsm/controls/OrbitControls.js\");function l(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function m(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var o={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(\"default\"!==a&&{}.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(o,a,i):o[a]=e[a]}return o.default=e,n&&n.set(e,o),o}var c,p=\"\",f=[],h=[],y=0,g={},w=[],v=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),E=new a.Player({app:{token:\"GfeiLX99kNC1YEyp\",valenceArousalEnabled:!0,vocalAmplitudeEnabled:!0},mediaElement:document.createElement(\"audio\")});function b(){var e,t=document.getElementById(\"playBtn\"),n=document.getElementById(\"pauseBtn\"),o=document.getElementById(\"explodeBtn\"),r=document.getElementById(\"volumeSlider\"),a=document.getElementById(\"hamburger-menu\"),i=document.getElementById(\"controls\"),d=document.getElementById(\"seekbar\");t.addEventListener(\"click\",M),n.addEventListener(\"click\",B),r.addEventListener(\"input\",k),a.addEventListener(\"click\",function(){i.classList.toggle(\"hidden\")}),d.addEventListener(\"input\",P),o.addEventListener(\"touchstart\",function(){e=Date.now()}),o.addEventListener(\"touchend\",function(){Date.now()-e<300&&I()}),o.addEventListener(\"click\",I)}function M(){E.requestPlay()}function B(){E.requestPause()}function P(){var e=document.getElementById(\"seekbar\");E.requestMediaSeek(e.value)}function I(){f.forEach(function(e){var t=new i.Vector3(.5*(Math.random()-.5),.5*(Math.random()-.5),.5*(Math.random()-.5));e.position.add(t)}),x()}function x(){for(var e=v?50:100,n=new i.BufferGeometry,o=new Float32Array(3*e),r=new Float32Array(3*e),a=new Float32Array(3*e),d=new Float32Array(3*e),s=new i.Color,u=0;u<e;u++){var l=10*(Math.random()-.5),m=10*(Math.random()-.5),p=10*(Math.random()-.5);o[3*u]=l,o[3*u+1]=m,o[3*u+2]=p,a[3*u]=.1*(Math.random()-.5),a[3*u+1]=-.1*Math.random()-.05,a[3*u+2]=.1*(Math.random()-.5),d[3*u]=Math.random()*Math.PI*2,d[3*u+1]=Math.random()*Math.PI*2,d[3*u+2]=Math.random()*Math.PI*2,s.setHSL(Math.random(),1,.5),r[3*u]=s.r,r[3*u+1]=s.g,r[3*u+2]=s.b}n.setAttribute(\"position\",new i.BufferAttribute(o,3)),n.setAttribute(\"color\",new i.BufferAttribute(r,3));var f=new i.PointsMaterial({size:.1,vertexColors:!0});(c=new i.Points(n,f)).userData.velocities=a,c.userData.rotations=d,t.add(c),setTimeout(function(){t.remove(c),c.geometry.dispose(),c.material.dispose(),c=null},3e3)}function L(){if(c){for(var e=c.geometry.attributes.position.array,t=c.userData.velocities,n=c.userData.rotations,o=0;o<e.length;o+=3){e[o]+=t[o],e[o+1]+=t[o+1],e[o+2]+=t[o+2],t[o+1]-=.0098,n[o]+=.01,n[o+1]+=.01,n[o+2]+=.01;var r=.3*Math.sin(n[o])+.7;c.geometry.attributes.position.array[o]*=r,c.geometry.attributes.position.array[o+1]*=r}c.geometry.attributes.position.needsUpdate=!0}}function k(){var e=document.getElementById(\"volumeSlider\").value/100;E.volume=e}function A(){var a;t=new i.Scene,n=new i.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),o=new i.WebGLRenderer({antialias:!1,powerPreference:\"low-power\"}),v?o.setPixelRatio(1):o.setPixelRatio(Math.min(window.devicePixelRatio,2)),o.setSize(window.innerWidth,window.innerHeight),document.getElementById(\"container\").appendChild(o.domElement),(new i.TextureLoader).load(\"low_res_starry_sky.jpg\",function(e){e.minFilter=i.LinearFilter,t.background=e}),n.position.z=5,(r=new u.OrbitControls(n,o.domElement)).enableDamping=!0,r.dampingFactor=.25,r.screenSpacePanning=!1,r.minDistance=1,r.maxDistance=100,e=new i.Group,t.add(e),_(),window.addEventListener(\"resize\",function(){clearTimeout(a),a=setTimeout(q,100)})}function j(){if(p){var t=v?3:5,n=p.split(/\\s+/).slice(0,t);(new d.FontLoader).load(\"Zen Old Mincho Black_Regular.json\",function(t){n.forEach(function(n,o){g[n]||(g[n]=new s.TextGeometry(n,{font:t,size:.4,height:.1}),g[n].center());var r=S(n,new i.MeshBasicMaterial({color:16777215}));r.position.set(5*(Math.random()-.5),10+2*o,5*(Math.random()-.5)),f.push(r),h.push({mesh:r,speed:.05+.05*Math.random(),rotationSpeed:{x:.02*(Math.random()-.5),y:.02*(Math.random()-.5),z:.02*(Math.random()-.5)}}),e.add(r)})})}}function S(e,t){if(w.length>0){var n=w.pop();return n.geometry=g[e],n.material=t,n}return new i.Mesh(g[e],t)}function O(e){w.length<50?w.push(e):z(e)}function D(){var e=E.getValenceArousal(E.timer.position),t=E.getValenceArousal(E.timer.position),n=new i.Color;n.setHSL((e+1)/2,1,(t+1)/2),f.forEach(function(e){e.material.color.set(n)})}function F(){for(var t=h.length-1;t>=0;t--){var n=h[t];n.mesh.position.y-=n.speed,n.mesh.rotation.x+=n.rotationSpeed.x,n.mesh.rotation.y+=n.rotationSpeed.y,n.mesh.rotation.z+=n.rotationSpeed.z,n.mesh.position.y<-5&&(e.remove(n.mesh),h.splice(t,1),O(n.mesh))}}function _(e){requestAnimationFrame(_),e-y>1e3/(v?20:30)&&(y=e,F(),L(),r.update(),o&&n&&o.render(t,n))}function q(){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function z(e){e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(function(e){return e.dispose()}):e.material.dispose())}function C(){f.forEach(function(e){z(e)}),f=[],h=[],c&&(t.remove(c),c.geometry.dispose(),c.material.dispose(),c=null),Object.values(g).forEach(function(e){return e.dispose()}),g={},w.forEach(function(e){return z(e)}),w=[]}E.addListener({onAppReady:function(e){e.managed||E.createFromSongUrl(\"https://piapro.jp/t/YW_d/20210206123357\"),b()},onVideoReady:function(e){document.getElementById(\"playBtn\").disabled=!1,document.getElementById(\"pauseBtn\").disabled=!1,document.getElementById(\"explodeBtn\").disabled=!1,document.getElementById(\"seekbar\").max=E.video.duration},onTimerReady:function(){A()},onTimeUpdate:function(e){if(E.video){var t=E.timer.position,n=E.video.findChar(t);n&&n.text!==p&&(p=n.text,j()),D(),document.getElementById(\"seekbar\").value=t}},onPlay:function(){document.getElementById(\"playBtn\").disabled=!0,document.getElementById(\"pauseBtn\").disabled=!1},onPause:function(){document.getElementById(\"playBtn\").disabled=!1,document.getElementById(\"pauseBtn\").disabled=!0}}),window.addEventListener(\"beforeunload\",C);"},"sourceMaps":null,"error":null,"hash":"4fbca207ff30b6a11e8080f8c65c6eed","cacheData":{"env":{}}}