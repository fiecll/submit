{"id":"mpVp","dependencies":[{"name":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\package.json","includedInParent":true,"mtime":1720181853972},{"name":"textalive-app-api","loc":{"line":1,"column":23,"index":23},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\textalive-app-api\\dist\\index.es.js"},{"name":"three","loc":{"line":6,"column":30,"index":328},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\build\\three.module.js"},{"name":"three/examples/jsm/loaders/FontLoader.js","loc":{"line":3,"column":27,"index":105},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\loaders\\FontLoader.js"},{"name":"three/examples/jsm/geometries/TextGeometry.js","loc":{"line":4,"column":29,"index":179},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\geometries\\TextGeometry.js"},{"name":"three/examples/jsm/loaders/GLTFLoader","loc":{"line":5,"column":27,"index":256},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\loaders\\GLTFLoader.js"},{"name":"three/examples/jsm/controls/OrbitControls.js","loc":{"line":7,"column":30,"index":368},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\controls\\OrbitControls.js"}],"generated":{"js":"\"use strict\";var e,t,n,o,a,r=require(\"textalive-app-api\"),i=p(require(\"three\")),d=i,s=require(\"three/examples/jsm/loaders/FontLoader.js\"),l=require(\"three/examples/jsm/geometries/TextGeometry.js\"),u=require(\"three/examples/jsm/loaders/GLTFLoader\"),c=require(\"three/examples/jsm/controls/OrbitControls.js\");function m(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var o={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(\"default\"!==r&&{}.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}var f,h=\"\",g=[],y=[],w=0,v=new r.Player({app:{token:\"GfeiLX99kNC1YEyp\",valenceArousalEnabled:!0,vocalAmplitudeEnabled:!0},mediaElement:document.createElement(\"audio\")});function E(){var e=document.getElementById(\"playBtn\"),t=document.getElementById(\"pauseBtn\"),n=document.getElementById(\"explodeBtn\"),o=document.getElementById(\"volumeSlider\"),a=document.getElementById(\"hamburger-menu\"),r=document.getElementById(\"controls\"),i=document.getElementById(\"seekbar\");e.addEventListener(\"click\",B),t.addEventListener(\"click\",M),n.addEventListener(\"click\",x),o.addEventListener(\"input\",L),a.addEventListener(\"click\",function(){r.classList.toggle(\"hidden\")}),i.addEventListener(\"input\",b)}function B(){v.requestPlay().then(function(){console.log(\"再生開始\")}).catch(function(e){console.log(\"エラー: \"+e.message)})}function M(){v.requestPause().then(function(){console.log(\"一時停止\")}).catch(function(e){console.log(\"エラー: \"+e.message)})}function b(){var e=document.getElementById(\"seekbar\");v.requestMediaSeek(e.value).then(function(){console.log(\"シーク位置:\",e.value)}).catch(function(e){console.log(\"エラー: \"+e.message)})}function x(){g.forEach(function(e){var t=new d.Vector3(.5*(Math.random()-.5),.5*(Math.random()-.5),.5*(Math.random()-.5));e.position.add(t)}),I()}function I(){for(var e=new d.BufferGeometry,n=new Float32Array(300),o=new Float32Array(300),a=new Float32Array(300),r=new Float32Array(300),i=new d.Color,s=0;s<100;s++){var l=10*(Math.random()-.5),u=10*(Math.random()-.5),c=10*(Math.random()-.5);n[3*s]=l,n[3*s+1]=u,n[3*s+2]=c,a[3*s]=.1*(Math.random()-.5),a[3*s+1]=-.1*Math.random()-.05,a[3*s+2]=.1*(Math.random()-.5),r[3*s]=Math.random()*Math.PI*2,r[3*s+1]=Math.random()*Math.PI*2,r[3*s+2]=Math.random()*Math.PI*2,i.setHSL(Math.random(),1,.5),o[3*s]=i.r,o[3*s+1]=i.g,o[3*s+2]=i.b}e.setAttribute(\"position\",new d.BufferAttribute(n,3)),e.setAttribute(\"color\",new d.BufferAttribute(o,3));var m=new d.PointsMaterial({size:.1,vertexColors:!0});(f=new d.Points(e,m)).userData.velocities=a,f.userData.rotations=r,t.add(f),setTimeout(function(){t.remove(f),f=null},3e3)}function P(){if(f){for(var e=f.geometry.attributes.position.array,t=f.userData.velocities,n=f.userData.rotations,o=0;o<e.length;o+=3){e[o]+=t[o],e[o+1]+=t[o+1],e[o+2]+=t[o+2],t[o+1]-=.0098,n[o]+=.01,n[o+1]+=.01,n[o+2]+=.01;var a=.3*Math.sin(n[o])+.7;f.geometry.attributes.position.array[o]*=a,f.geometry.attributes.position.array[o+1]*=a}f.geometry.attributes.position.needsUpdate=!0}}function L(){var e=document.getElementById(\"volumeSlider\").value/100;v.volume=10*e}function k(){var r;t=new d.Scene,n=new d.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),(o=new d.WebGLRenderer({antialias:!1,powerPreference:\"low-power\"})).setPixelRatio(.5*window.devicePixelRatio),o.setSize(window.innerWidth,window.innerHeight),document.getElementById(\"container\").appendChild(o.domElement),(new i.TextureLoader).load(\"low_res_starry_sky.jpg\",function(e){t.background=e}),n.position.z=5,(a=new c.OrbitControls(n,o.domElement)).enableDamping=!0,a.dampingFactor=.25,a.screenSpacePanning=!1,a.minDistance=1,a.maxDistance=100,e=new d.Group,t.add(e),_(),window.addEventListener(\"resize\",function(){clearTimeout(r),r=setTimeout(q,100)})}function j(){if(h){console.log(h);var t=h.split(/\\s+/);(new s.FontLoader).load(\"Zen Old Mincho Black_Regular.json\",function(n){t.forEach(function(t,o){var a=new l.TextGeometry(t,{font:n,size:.4,height:.1});a.computeBoundingBox(),a.center();var r=new d.MeshBasicMaterial({color:16777215}),i=new d.Mesh(a,r);i.position.set(5*(Math.random()-.5),10+2*o,5*(Math.random()-.5)),g.push(i),y.push({mesh:i,speed:.05+.05*Math.random(),rotationSpeed:{x:.02*(Math.random()-.5),y:.02*(Math.random()-.5),z:.02*(Math.random()-.5)}}),e.add(i)})})}}function A(){var e=v.getValenceArousal(v.timer.position),t=v.getValenceArousal(v.timer.position);console.log(\"valence:\",e,\"arousal:\",t);var n=new d.Color;n.setHSL((e+1)/2,1,(t+1)/2),g.forEach(function(e){e.material.color.set(n)})}function S(){y.forEach(function(e,t){e.mesh.position.y-=e.speed,e.mesh.rotation.x+=e.rotationSpeed.x,e.mesh.rotation.y+=e.rotationSpeed.y,e.mesh.rotation.z+=e.rotationSpeed.z,e.mesh.position.y<-5&&(e.mesh.position.y=10)})}function _(e){requestAnimationFrame(_),e-w>1e3/30&&(w=e,S(),P(),a.update(),o&&n&&o.render(t,n))}function q(){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function F(e){e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(function(e){return e.dispose()}):e.material.dispose())}function O(){t.traverse(function(e){e.isMesh&&F(e)})}v.addListener({onAppReady:function(e){e.managed||(v.createFromSongUrl(\"https://piapro.jp/t/YW_d/20210206123357\"),console.log(v.data.song)),E()},onVideoReady:function(e){document.getElementById(\"playBtn\").disabled=!1,document.getElementById(\"pauseBtn\").disabled=!1,document.getElementById(\"explodeBtn\").disabled=!1,document.getElementById(\"seekbar\").max=v.video.duration},onTimerReady:function(){k()},onTimeUpdate:function(e){if(console.log(\"再生位置のアップデート:\",e,\"ミリ秒\"),v.video){var t=v.timer.position,n=v.video.findChar(t);n&&n.text!==h&&(h=n.text,j()),A(),document.getElementById(\"seekbar\").value=t}},onPlay:function(){document.getElementById(\"playBtn\").disabled=!0,document.getElementById(\"pauseBtn\").disabled=!1,console.log(\"再生\")},onPause:function(){document.getElementById(\"playBtn\").disabled=!1,document.getElementById(\"pauseBtn\").disabled=!0,console.log(\"一時停止\")}}),window.addEventListener(\"beforeunload\",O);"},"sourceMaps":null,"error":null,"hash":"336b58c023c69471c818f03610c37fbd","cacheData":{"env":{}}}