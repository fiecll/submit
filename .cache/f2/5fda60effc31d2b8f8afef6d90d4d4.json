{"id":"mpVp","dependencies":[{"name":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\package.json","includedInParent":true,"mtime":1720181853972},{"name":"textalive-app-api","loc":{"line":1,"column":23,"index":23},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\textalive-app-api\\dist\\index.es.js"},{"name":"three","loc":{"line":6,"column":30,"index":328},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\build\\three.module.js"},{"name":"three/examples/jsm/loaders/FontLoader.js","loc":{"line":3,"column":27,"index":105},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\loaders\\FontLoader.js"},{"name":"three/examples/jsm/geometries/TextGeometry.js","loc":{"line":4,"column":29,"index":179},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\geometries\\TextGeometry.js"},{"name":"three/examples/jsm/loaders/GLTFLoader","loc":{"line":5,"column":27,"index":256},"parent":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\src\\script.js","resolved":"C:\\Users\\81805\\Desktop\\textalive-music-app - コピー\\node_modules\\three\\examples\\jsm\\loaders\\GLTFLoader.js"}],"generated":{"js":"\"use strict\";var e,t,n,o,a=require(\"textalive-app-api\"),r=c(require(\"three\")),i=r,d=require(\"three/examples/jsm/loaders/FontLoader.js\"),s=require(\"three/examples/jsm/geometries/TextGeometry.js\"),l=require(\"three/examples/jsm/loaders/GLTFLoader\");function u(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function c(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var o={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(\"default\"!==r&&{}.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}var m,p=\"\",f=[],h=[],y=new a.Player({app:{token:\"GfeiLX99kNC1YEyp\",valenceArousalEnabled:!0,vocalAmplitudeEnabled:!0},mediaElement:document.createElement(\"audio\")});function g(){var e=document.getElementById(\"playBtn\"),t=document.getElementById(\"pauseBtn\"),n=document.getElementById(\"explodeBtn\"),o=document.getElementById(\"volumeSlider\");e.addEventListener(\"click\",w),t.addEventListener(\"click\",v),n.addEventListener(\"click\",M),o.addEventListener(\"input\",b)}function w(){y.requestPlay().then(function(){console.log(\"再生開始\")}).catch(function(e){console.log(\"エラー: \"+e.message)})}function v(){y.requestPause().then(function(){console.log(\"一時停止\")}).catch(function(e){console.log(\"エラー: \"+e.message)})}function M(){f.forEach(function(e){var t=new i.Vector3(.5*(Math.random()-.5),.5*(Math.random()-.5),.5*(Math.random()-.5));e.position.add(t)}),B()}function B(){for(var e=new i.BufferGeometry,n=new Float32Array(600),o=new Float32Array(600),a=new Float32Array(600),r=new Float32Array(600),d=new i.Color,s=0;s<200;s++){var l=10*(Math.random()-.5),u=10*(Math.random()-.5),c=10*(Math.random()-.5);n[3*s]=l,n[3*s+1]=u,n[3*s+2]=c,a[3*s]=.1*(Math.random()-.5),a[3*s+1]=-.1*Math.random()-.05,a[3*s+2]=.1*(Math.random()-.5),r[3*s]=Math.random()*Math.PI*2,r[3*s+1]=Math.random()*Math.PI*2,r[3*s+2]=Math.random()*Math.PI*2,d.setHSL(Math.random(),1,.5),o[3*s]=d.r,o[3*s+1]=d.g,o[3*s+2]=d.b}e.setAttribute(\"position\",new i.BufferAttribute(n,3)),e.setAttribute(\"color\",new i.BufferAttribute(o,3));var p=new i.PointsMaterial({size:.1,vertexColors:!0});(m=new i.Points(e,p)).userData.velocities=a,m.userData.rotations=r,t.add(m),setTimeout(function(){t.remove(m),m=null},3e3)}function E(){if(m){for(var e=m.geometry.attributes.position.array,t=m.userData.velocities,n=m.userData.rotations,o=0;o<e.length;o+=3){e[o]+=t[o],e[o+1]+=t[o+1],e[o+2]+=t[o+2],t[o+1]-=.0098,n[o]+=.01,n[o+1]+=.01,n[o+2]+=.01;var a=.3*Math.sin(n[o])+.7;m.geometry.attributes.position.array[o]*=a,m.geometry.attributes.position.array[o+1]*=a}m.geometry.attributes.position.needsUpdate=!0}}function b(){var e=document.getElementById(\"volumeSlider\").value/100;y.volume=10*e}function P(){t=new i.Scene,n=new i.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),(o=new i.WebGLRenderer({antialias:!0})).setSize(window.innerWidth,window.innerHeight),o.setPixelRatio(window.devicePixelRatio),document.getElementById(\"container\").appendChild(o.domElement),(new r.TextureLoader).load(\"starry_sky.jpg\",function(e){t.background=e}),n.position.z=5,e=new i.Group,t.add(e),j(),window.addEventListener(\"resize\",L)}function x(){if(p){console.log(p);var t=p.split(/\\s+/);(new d.FontLoader).load(\"Zen Old Mincho Black_Regular.json\",function(n){t.forEach(function(t,o){var a=new s.TextGeometry(t,{font:n,size:.4,height:.1});a.computeBoundingBox(),a.center();var r=new i.MeshBasicMaterial({color:16777215}),d=new i.Mesh(a,r);d.position.set(5*(Math.random()-.5),10+2*o,5*(Math.random()-.5)),f.push(d),h.push({mesh:d,speed:.05+.05*Math.random(),rotationSpeed:{x:.02*(Math.random()-.5),y:.02*(Math.random()-.5),z:.02*(Math.random()-.5)}}),e.add(d)})})}}function I(){h.forEach(function(e,t){e.mesh.position.y-=e.speed,e.mesh.rotation.x+=e.rotationSpeed.x,e.mesh.rotation.y+=e.rotationSpeed.y,e.mesh.rotation.z+=e.rotationSpeed.z,e.mesh.position.y<-5&&(e.mesh.position.y=10)})}function j(){requestAnimationFrame(j),I(),E(),o.render(t,n)}function L(){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}y.addListener({onAppReady:function(e){e.managed||(y.createFromSongUrl(\"https://piapro.jp/t/YW_d/20210206123357\"),console.log(y.data.song)),g()},onVideoReady:function(e){document.getElementById(\"playBtn\").disabled=!1,document.getElementById(\"pauseBtn\").disabled=!1,document.getElementById(\"explodeBtn\").disabled=!1},onTimerReady:function(){P()},onTimeUpdate:function(e){if(console.log(\"再生位置のアップデート:\",e,\"ミリ秒\"),y.video){var t=y.timer.position,n=y.video.findPhrase(t);n&&n.text!==p&&(p=n.text,x())}},onPlay:function(){document.getElementById(\"playBtn\").disabled=!0,document.getElementById(\"pauseBtn\").disabled=!1,console.log(\"再生\")},onPause:function(){document.getElementById(\"playBtn\").disabled=!1,document.getElementById(\"pauseBtn\").disabled=!0,console.log(\"一時停止\")}});"},"sourceMaps":null,"error":null,"hash":"313e56c787594c935b51112cb91311ef","cacheData":{"env":{}}}